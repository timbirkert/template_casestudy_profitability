import React, { useState } from 'react';

export default function ProfitabilityCaseFramework() {
  const [activeSection, setActiveSection] = useState(null);

  const Section = ({ id, title, color, children, step }) => (
    <div 
      className={`mb-4 rounded-lg border-2 ${color} cursor-pointer transition-all duration-200 ${activeSection === id ? 'shadow-lg' : 'hover:shadow-md'}`}
      onClick={() => setActiveSection(activeSection === id ? null : id)}
    >
      <div className={`p-3 ${color.replace('border', 'bg').replace('-600', '-100')}`}>
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-2">
            <span className={`w-8 h-8 rounded-full ${color.replace('border', 'bg').replace('-600', '-600')} text-white flex items-center justify-center font-bold text-sm`}>
              {step}
            </span>
            <h2 className="font-bold text-gray-800">{title}</h2>
          </div>
          <span className="text-gray-500 text-sm">{activeSection === id ? '‚ñº' : '‚ñ∂'}</span>
        </div>
      </div>
      {activeSection === id && (
        <div className="p-4 bg-white">
          {children}
        </div>
      )}
    </div>
  );

  const SubSection = ({ title, items, color }) => (
    <div className="mb-3">
      <h3 className={`font-semibold text-sm ${color.replace('border', 'text').replace('-600', '-700')} mb-1`}>{title}</h3>
      <ul className="text-sm text-gray-700 space-y-1">
        {items.map((item, i) => (
          <li key={i} className="flex items-start gap-2">
            <span className="text-gray-400 mt-1">‚Ä¢</span>
            <span>{item}</span>
          </li>
        ))}
      </ul>
    </div>
  );

  const Formula = ({ formula, description }) => (
    <div className="bg-gray-100 rounded p-2 my-2 text-center">
      <div className="font-mono font-bold text-gray-800">{formula}</div>
      {description && <div className="text-xs text-gray-500 mt-1">{description}</div>}
    </div>
  );

  return (
    <div className="p-4 bg-gray-50 min-h-screen">
      <div className="max-w-2xl mx-auto">
        {/* Header */}
        <div className="text-center mb-6">
          <h1 className="text-2xl font-bold text-gray-800 mb-2">Profitability Case Framework</h1>
          <p className="text-sm text-gray-500">Klicke auf jeden Schritt f√ºr Details</p>
        </div>

        {/* Core Formula */}
        <div className="bg-blue-900 text-white p-4 rounded-lg mb-6 text-center">
          <div className="text-sm uppercase tracking-wide mb-1">Kernformel</div>
          <div className="text-2xl font-bold">Profit = Revenue ‚àí Costs</div>
          <div className="text-sm mt-2 opacity-80">
            Revenue = Price √ó Quantity | Costs = Fixed + Variable
          </div>
        </div>

        {/* Step 1: Problem Definition */}
        <Section id="problem" title="Problem Definition & Clarification" color="border-blue-600" step="1">
          <SubSection 
            title="Wiederhole das Problem" 
            color="border-blue-600"
            items={[
              "Fasse das Problem in eigenen Worten zusammen",
              "\"Wenn ich richtig verstehe, ist das Ziel...\"",
              "Best√§tige die Zielsetzung mit dem Interviewer"
            ]}
          />
          <SubSection 
            title="Kl√§rungs-Fragen stellen" 
            color="border-blue-600"
            items={[
              "Zeitrahmen: Seit wann besteht das Problem? Kurzfristig oder langfristiger Trend?",
              "Scope: Gesamtes Unternehmen oder spezifische Bereiche/Produkte/Regionen?",
              "Benchmark: Um wie viel ist Profitabilit√§t gesunken? Absolut oder relativ?",
              "Erfolgsmessung: Welche KPIs definieren Erfolg?",
              "Unternehmensspezifisch: Gibt es k√ºrzliche √Ñnderungen (neues Produkt, Akquisition, Managementwechsel)?"
            ]}
          />
          <div className="bg-yellow-50 border border-yellow-200 rounded p-2 mt-3">
            <div className="text-sm font-semibold text-yellow-800">üí° Tipp</div>
            <div className="text-sm text-yellow-700">Nimm dir 30-60 Sekunden Zeit f√ºr Notizen und Strukturierung bevor du anf√§ngst.</div>
          </div>
        </Section>

        {/* Step 2: External Analysis */}
        <Section id="external" title="External Analysis" color="border-green-600" step="2">
          <p className="text-sm text-gray-600 mb-3 italic">Ist es ein unternehmensspezifisches oder branchenweites Problem?</p>
          
          <SubSection 
            title="Makro√∂konomische Faktoren (solltest du wissen)" 
            color="border-green-600"
            items={[
              "Zinsniveau: Beeinflusst Finanzierungskosten und Konsumverhalten",
              "Inflation: Erh√∂ht Input-Kosten, beeinflusst Preissetzungsmacht",
              "Wechselkurse: Relevant bei Import/Export",
              "Arbeitslosenquote: Beeinflusst Konsumausgaben und Lohnkosten",
              "Rohstoffpreise: √ñl, Gas, Metalle ‚Äì branchenabh√§ngig",
              "Konjunkturzyklus: Rezession, Erholung, Boom"
            ]}
          />
          
          <SubSection 
            title="Industry Analysis (Daten vom Interviewer)" 
            color="border-green-600"
            items={[
              "Marktwachstum: W√§chst, stagniert oder schrumpft der Markt?",
              "Marktgr√∂√üe: TAM, SAM, SOM",
              "Marktanteilsverteilung: Fragmentiert oder konzentriert?",
              "Kundensegmentierung: B2B/B2C, Segmentgr√∂√üen, Trends",
              "Preistrends: Steigend, fallend, stabil?"
            ]}
          />

          <SubSection 
            title="Porter's Five Forces" 
            color="border-green-600"
            items={[
              "Wettbewerbsintensit√§t: Viele Wettbewerber? Preisk√§mpfe?",
              "Neue Eintreter: Niedrige Eintrittsbarrieren?",
              "Substitutionsrisiko: Alternative Produkte/Technologien?",
              "Kundenverhandlungsmacht: Konzentrierte Kunden?",
              "Lieferantenmacht: Abh√§ngigkeit von wenigen Lieferanten?"
            ]}
          />

          <div className="bg-green-50 border border-green-200 rounded p-2 mt-3">
            <div className="text-sm font-semibold text-green-800">üìù Notiere f√ºr alles:</div>
            <div className="text-sm text-green-700">Aktueller Stand + Trend (‚Üë‚Üì‚Üí) + Vergleich zu Wettbewerbern</div>
          </div>
        </Section>

        {/* Step 3: Internal Analysis */}
        <Section id="internal" title="Internal Analysis" color="border-purple-600" step="3">
          <p className="text-sm text-gray-600 mb-3 italic">Ist es ein Revenue-Problem oder ein Cost-Problem? (Oder beides?)</p>
          
          <div className="grid grid-cols-2 gap-4 mb-4">
            {/* Revenue Side */}
            <div className="bg-emerald-50 rounded-lg p-3 border border-emerald-200">
              <h3 className="font-bold text-emerald-800 mb-2 text-center">Revenue</h3>
              <Formula formula="R = P √ó Q" />
              
              <div className="text-sm space-y-2">
                <div>
                  <div className="font-semibold text-emerald-700">Price-Probleme:</div>
                  <ul className="text-gray-600 ml-2">
                    <li>‚Ä¢ Preisdruck durch Wettbewerb</li>
                    <li>‚Ä¢ Rabattaktionen/Promotions</li>
                    <li>‚Ä¢ Produktmix-Shift zu g√ºnstigeren Produkten</li>
                    <li>‚Ä¢ W√§hrungseffekte</li>
                  </ul>
                </div>
                <div>
                  <div className="font-semibold text-emerald-700">Quantity-Probleme:</div>
                  <ul className="text-gray-600 ml-2">
                    <li>‚Ä¢ Marktanteilsverlust</li>
                    <li>‚Ä¢ Schrumpfender Gesamtmarkt</li>
                    <li>‚Ä¢ Kundenabwanderung (Churn)</li>
                    <li>‚Ä¢ Saisonale Effekte</li>
                  </ul>
                </div>
              </div>
            </div>

            {/* Cost Side */}
            <div className="bg-red-50 rounded-lg p-3 border border-red-200">
              <h3 className="font-bold text-red-800 mb-2 text-center">Costs</h3>
              <Formula formula="C = FC + VC" />
              
              <div className="text-sm space-y-2">
                <div>
                  <div className="font-semibold text-red-700">Fixkosten:</div>
                  <ul className="text-gray-600 ml-2">
                    <li>‚Ä¢ Miete, Geh√§lter, Versicherung</li>
                    <li>‚Ä¢ Abschreibungen</li>
                    <li>‚Ä¢ IT-Infrastruktur</li>
                    <li>‚Ä¢ Management Overhead</li>
                  </ul>
                </div>
                <div>
                  <div className="font-semibold text-red-700">Variable Kosten:</div>
                  <ul className="text-gray-600 ml-2">
                    <li>‚Ä¢ Rohstoffe/COGS</li>
                    <li>‚Ä¢ Produktion/Arbeit</li>
                    <li>‚Ä¢ Vertriebsprovisionen</li>
                    <li>‚Ä¢ Logistik/Versand</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <SubSection 
            title="Revenue-Aufschl√ºsselung erfragen" 
            color="border-purple-600"
            items={[
              "Nach Produktlinien/Services",
              "Nach Kundensegmenten (B2B/B2C, Gro√ü-/Kleinkunden)",
              "Nach Regionen/M√§rkten",
              "Nach Vertriebskan√§len (Direkt, Online, Partner)"
            ]}
          />

          <SubSection 
            title="Cost-Aufschl√ºsselung erfragen" 
            color="border-purple-600"
            items={[
              "COGS (Cost of Goods Sold)",
              "SG&A (Selling, General & Administrative)",
              "R&D (Research & Development)",
              "Benchmark vs. Wettbewerber: Wo liegen wir h√∂her/niedriger?"
            ]}
          />

          <div className="bg-purple-50 border border-purple-200 rounded p-2 mt-3">
            <div className="text-sm font-semibold text-purple-800">üìä Visualisiere:</div>
            <div className="text-sm text-purple-700">Erstelle einen Revenue-Baum und einen Cost-Baum. Markiere Abweichungen mit ‚Üë‚Üì.</div>
          </div>
        </Section>

        {/* Step 4: Root Cause */}
        <Section id="rootcause" title="Root Cause Identification" color="border-orange-600" step="4">
          <p className="text-sm text-gray-600 mb-3">Bevor du L√∂sungen vorschl√§gst: Was ist die Hauptursache?</p>
          
          <SubSection 
            title="Synthese der Erkenntnisse" 
            color="border-orange-600"
            items={[
              "Welche Faktoren haben den gr√∂√üten Impact auf den Profit?",
              "Ist das Problem extern (Markt/Wettbewerb) oder intern (Operations)?",
              "Ist es tempor√§r oder strukturell?",
              "Sind mehrere Ursachen verkn√ºpft?"
            ]}
          />

          <div className="bg-orange-100 rounded p-3 my-3">
            <div className="font-semibold text-orange-800 mb-2">Framework: Isoliere die Ursache</div>
            <div className="text-sm text-gray-700 space-y-1">
              <div>1. <strong>Revenue oder Cost?</strong> ‚Üí Welche Seite treibt das Problem?</div>
              <div>2. <strong>Price oder Volume?</strong> / <strong>Fix oder Variabel?</strong></div>
              <div>3. <strong>Welches Segment/Produkt/Region?</strong> ‚Üí Wo genau?</div>
              <div>4. <strong>Warum dort?</strong> ‚Üí Tiefere Ursache identifizieren</div>
            </div>
          </div>

          <div className="bg-yellow-50 border border-yellow-200 rounded p-2">
            <div className="text-sm font-semibold text-yellow-800">üí° Kommunikation</div>
            <div className="text-sm text-yellow-700">"Basierend auf meiner Analyse sehe ich [X] als Hauptursache, weil [Evidenz]. Soll ich hier tiefer einsteigen oder L√∂sungen entwickeln?"</div>
          </div>
        </Section>

        {/* Step 5: Solutions */}
        <Section id="solutions" title="Solutions Development" color="border-indigo-600" step="5">
          <p className="text-sm text-gray-600 mb-3">Strukturiere L√∂sungen entlang zweier Dimensionen:</p>

          {/* 2x2 Matrix */}
          <div className="grid grid-cols-2 gap-1 mb-4 text-sm">
            <div className="col-span-2 grid grid-cols-3 gap-1">
              <div></div>
              <div className="text-center font-bold text-gray-600 p-2">Kurzfristig (0-6 Mo)</div>
              <div className="text-center font-bold text-gray-600 p-2">Langfristig (6+ Mo)</div>
            </div>
            
            <div className="font-bold text-gray-600 p-2 flex items-center">Revenue</div>
            <div className="bg-emerald-100 p-2 rounded">
              <ul className="text-xs space-y-1">
                <li>‚Ä¢ Preiserh√∂hungen</li>
                <li>‚Ä¢ Cross-/Upselling Push</li>
                <li>‚Ä¢ Promotions stoppen</li>
                <li>‚Ä¢ Sales-Incentives anpassen</li>
              </ul>
            </div>
            <div className="bg-emerald-200 p-2 rounded">
              <ul className="text-xs space-y-1">
                <li>‚Ä¢ Neue Produkte/Services</li>
                <li>‚Ä¢ Neue M√§rkte/Segmente</li>
                <li>‚Ä¢ Vertriebskan√§le ausbauen</li>
                <li>‚Ä¢ M&A f√ºr Wachstum</li>
              </ul>
            </div>

            <div className="font-bold text-gray-600 p-2 flex items-center">Costs</div>
            <div className="bg-red-100 p-2 rounded">
              <ul className="text-xs space-y-1">
                <li>‚Ä¢ Hiring Freeze</li>
                <li>‚Ä¢ Discretionary Spend stoppen</li>
                <li>‚Ä¢ Nachverhandeln mit Lieferanten</li>
                <li>‚Ä¢ Quick-Win Prozessoptimierung</li>
              </ul>
            </div>
            <div className="bg-red-200 p-2 rounded">
              <ul className="text-xs space-y-1">
                <li>‚Ä¢ Restrukturierung</li>
                <li>‚Ä¢ Outsourcing</li>
                <li>‚Ä¢ Automatisierung</li>
                <li>‚Ä¢ Standortkonsolidierung</li>
              </ul>
            </div>
          </div>

          <SubSection 
            title="Zus√§tzliche L√∂sungskategorien" 
            color="border-indigo-600"
            items={[
              "Produktmix optimieren: Fokus auf margenstarke Produkte",
              "Kundenmix optimieren: Fokus auf profitable Segmente",
              "Working Capital: Lagerbest√§nde reduzieren, Zahlungsziele optimieren",
              "Pricing Power erh√∂hen: Differenzierung, Bundling, Wertbasierte Preise",
              "Skaleneffekte: Volumen erh√∂hen, Fixkostendegression",
              "Hedging: Rohstoff-Futures, W√§hrungsabsicherung"
            ]}
          />

          <SubSection 
            title="Priorisierung: Impact vs. Feasibility" 
            color="border-indigo-600"
            items={[
              "High Impact + High Feasibility ‚Üí Sofort umsetzen",
              "High Impact + Low Feasibility ‚Üí Strategische Projekte planen",
              "Low Impact + High Feasibility ‚Üí Quick Wins mitnehmen",
              "Low Impact + Low Feasibility ‚Üí Nicht priorisieren"
            ]}
          />
        </Section>

        {/* Step 6: Recommendation */}
        <Section id="recommendation" title="Recommendation & Next Steps" color="border-gray-600" step="6">
          <SubSection 
            title="Struktur der Empfehlung" 
            color="border-gray-600"
            items={[
              "1. Situation: Kurze Zusammenfassung des Problems",
              "2. Root Cause: Was ist die Hauptursache?",
              "3. Empfehlung: Top 2-3 priorisierte Ma√ünahmen",
              "4. Impact: Erwartete Verbesserung (quantifiziert wenn m√∂glich)",
              "5. Risiken: Was k√∂nnte schiefgehen?",
              "6. Next Steps: Konkrete n√§chste Schritte"
            ]}
          />

          <div className="bg-gray-100 rounded p-3 my-3">
            <div className="font-semibold text-gray-800 mb-2">Beispiel-Formulierung:</div>
            <div className="text-sm text-gray-700 italic">
              "Zusammenfassend hat [Unternehmen] ein Profitabilit√§tsproblem, das prim√§r durch [Root Cause] getrieben wird. Ich empfehle drei Ma√ünahmen: Erstens [kurzfristig], was [X%] Verbesserung bringen sollte. Zweitens [mittelfristig]. Drittens [langfristig]. Die Hauptrisiken sind [X] und [Y]. Als n√§chstes w√ºrde ich [konkrete Analyse/Daten] vorschlagen."
            </div>
          </div>

          <div className="bg-blue-50 border border-blue-200 rounded p-2">
            <div className="text-sm font-semibold text-blue-800">üí° Abschluss-Tipps</div>
            <div className="text-sm text-blue-700">
              ‚Ä¢ Sei spezifisch, nicht generisch<br/>
              ‚Ä¢ Quantifiziere wo m√∂glich<br/>
              ‚Ä¢ Zeige Trade-offs auf<br/>
              ‚Ä¢ Biete an, tiefer einzusteigen
            </div>
          </div>
        </Section>

        {/* Quick Reference */}
        <div className="mt-6 p-4 bg-white rounded-lg border-2 border-gray-300">
          <h2 className="font-bold text-gray-800 mb-3 text-center">üìã Quick Reference: Wichtige Kennzahlen</h2>
          <div className="grid grid-cols-2 gap-4 text-sm">
            <div>
              <div className="font-semibold text-gray-700 mb-1">Profitabilit√§t</div>
              <div className="text-gray-600 space-y-1">
                <div>Gross Margin = (Rev - COGS) / Rev</div>
                <div>Operating Margin = EBIT / Rev</div>
                <div>Net Margin = Net Profit / Rev</div>
                <div>EBITDA = EBIT + D&A</div>
              </div>
            </div>
            <div>
              <div className="font-semibold text-gray-700 mb-1">Unit Economics</div>
              <div className="text-gray-600 space-y-1">
                <div>CAC = Akquisekosten / Neukunden</div>
                <div>LTV = Margin √ó Kundenlebensdauer</div>
                <div>LTV/CAC sollte ‚â• 3:1 sein</div>
                <div>Churn = Lost Customers / Total</div>
              </div>
            </div>
            <div>
              <div className="font-semibold text-gray-700 mb-1">Break-even</div>
              <div className="text-gray-600 space-y-1">
                <div>BE = Fixkosten / Contribution Margin</div>
                <div>CM = Preis - Variable Kosten</div>
              </div>
            </div>
            <div>
              <div className="font-semibold text-gray-700 mb-1">Typische Margen</div>
              <div className="text-gray-600 space-y-1">
                <div>SaaS: 70-90% Gross</div>
                <div>Retail: 20-50% Gross, 2-5% Op</div>
                <div>Airlines: 2-5% Operating</div>
              </div>
            </div>
          </div>
        </div>

        {/* Footer */}
        <div className="text-center mt-6 text-xs text-gray-400">
          Case Interview Profitability Framework v1.0
        </div>
      </div>
    </div>
  );
}
